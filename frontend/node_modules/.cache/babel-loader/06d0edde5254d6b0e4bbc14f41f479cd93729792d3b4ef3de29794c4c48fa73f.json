{"ast":null,"code":"import React,{useState,useEffect}from'react';import api from'../services/api';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const NotificationBell=()=>{const[notifications,setNotifications]=useState([]);const[unreadCount,setUnreadCount]=useState(0);const[showDropdown,setShowDropdown]=useState(false);const[loading,setLoading]=useState(false);useEffect(()=>{fetchUnreadCount();fetchRecentNotifications();// Verificar notificaciones cada 5 minutos\nconst interval=setInterval(()=>{fetchUnreadCount();fetchRecentNotifications();},5*60*1000);return()=>clearInterval(interval);},[]);const fetchUnreadCount=async()=>{try{const response=await api.get('/notifications/notifications/unread_count/');setUnreadCount(response.data.unread_count);}catch(error){// Error silenciado\n}};const fetchRecentNotifications=async()=>{try{const response=await api.get('/notifications/notifications/recent/');setNotifications(response.data);}catch(error){// Error silenciado\n}};const markAsRead=async notificationId=>{try{await api.post(\"/notifications/notifications/\".concat(notificationId,\"/mark_read/\"));fetchUnreadCount();fetchRecentNotifications();}catch(error){// Error silenciado\n}};const markAllAsRead=async()=>{setLoading(true);try{await api.post('/notifications/notifications/mark_all_read/');setUnreadCount(0);fetchRecentNotifications();toast.success('Todas las notificaciones marcadas como leÃ­das');}catch(error){toast.error('Error al marcar notificaciones como leÃ­das');}finally{setLoading(false);}};const getPriorityColor=priority=>{switch(priority){case'urgent':return'#dc3545';case'high':return'#fd7e14';case'medium':return'#ffc107';case'low':return'#28a745';default:return'#6c757d';}};const getNotificationIcon=type=>{switch(type){case'goal_completed':return'ðŸŽ‰';case'goal_deadline':return'â°';case'goal_overdue':return'ðŸ“…';case'savings_reminder':return'ðŸ’°';case'milestone_reached':return'ðŸŽ¯';default:return'ðŸ“¢';}};return/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative',display:'inline-block'},children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowDropdown(!showDropdown),style:{background:'none',border:'none',color:'white',fontSize:'20px',cursor:'pointer',position:'relative',padding:'8px'},children:[\"\\uD83D\\uDD14\",unreadCount>0&&/*#__PURE__*/_jsx(\"span\",{style:{position:'absolute',top:'0',right:'0',backgroundColor:'#dc3545',color:'white',borderRadius:'50%',width:'20px',height:'20px',fontSize:'12px',display:'flex',alignItems:'center',justifyContent:'center',fontWeight:'bold'},children:unreadCount>99?'99+':unreadCount})]}),showDropdown&&/*#__PURE__*/_jsxs(\"div\",{style:{position:'absolute',top:'100%',right:'0',backgroundColor:'white',border:'1px solid #ddd',borderRadius:'8px',boxShadow:'0 4px 12px rgba(0,0,0,0.15)',width:'350px',maxHeight:'400px',overflowY:'auto',zIndex:1000},children:[/*#__PURE__*/_jsxs(\"div\",{style:{padding:'15px',borderBottom:'1px solid #eee',display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"h4\",{style:{margin:0,color:'#333'},children:\"Notificaciones\"}),unreadCount>0&&/*#__PURE__*/_jsx(\"button\",{onClick:markAllAsRead,disabled:loading,style:{background:'none',border:'none',color:'#007bff',cursor:'pointer',fontSize:'12px'},children:loading?'Marcando...':'Marcar todas como leÃ­das'})]}),/*#__PURE__*/_jsx(\"div\",{children:notifications.length===0?/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px',textAlign:'center',color:'#666'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'48px',marginBottom:'10px'},children:\"\\uD83D\\uDCED\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No tienes notificaciones\"})]}):notifications.map(notification=>/*#__PURE__*/_jsx(\"div\",{onClick:()=>!notification.leida&&markAsRead(notification.id),style:{padding:'12px 15px',borderBottom:'1px solid #f0f0f0',cursor:notification.leida?'default':'pointer',backgroundColor:notification.leida?'white':'#f8f9ff',borderLeft:\"4px solid \".concat(getPriorityColor(notification.prioridad)),transition:'background-color 0.2s ease'},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'flex-start',gap:'10px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'20px',flexShrink:0},children:getNotificationIcon(notification.tipo)}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1,minWidth:0},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:notification.leida?'normal':'bold',color:'#333',fontSize:'14px',marginBottom:'4px'},children:notification.titulo}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#666',fontSize:'13px',lineHeight:'1.4',marginBottom:'4px'},children:notification.mensaje}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#999',fontSize:'11px'},children:notification.tiempo_transcurrido})]}),!notification.leida&&/*#__PURE__*/_jsx(\"div\",{style:{width:'8px',height:'8px',backgroundColor:'#007bff',borderRadius:'50%',flexShrink:0,marginTop:'4px'}})]})},notification.id))}),notifications.length>0&&/*#__PURE__*/_jsx(\"div\",{style:{padding:'10px 15px',borderTop:'1px solid #eee',textAlign:'center'},children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowDropdown(false),style:{background:'none',border:'none',color:'#007bff',cursor:'pointer',fontSize:'12px'},children:\"Cerrar\"})})]}),showDropdown&&/*#__PURE__*/_jsx(\"div\",{onClick:()=>setShowDropdown(false),style:{position:'fixed',top:0,left:0,right:0,bottom:0,zIndex:999}})]});};export default NotificationBell;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}